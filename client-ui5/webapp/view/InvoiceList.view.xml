<mvc:View
    controllerName="invoice.app.controller.InvoiceList"
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core">
    
    <Page title="{invoiceList>/pageTitle}" showNavButton="true" navButtonPress="onNavBack">
        <content>
            <!-- Filter Bar -->
            <Bar>
                <contentLeft>
                    <Select id="statusFilter" change="onFilterChange" selectedKey="">
                        <items>
                            <core:Item key="" text="{i18n>allStatuses}"/>
                            <core:Item key="BORRADOR" text="BORRADOR"/>
                            <core:Item key="EMITIDA" text="EMITIDA"/>
                            <core:Item key="ENVIADA" text="ENVIADA"/>
                            <core:Item key="PAGADA" text="PAGADA"/>
                        </items>
                    </Select>
                </contentLeft>
                <contentRight>
                    <Button text="{i18n>newInvoice}" type="Emphasized" icon="sap-icon://add" press="onCreateInvoice"/>
                </contentRight>
            </Bar>

            <!-- Invoices Table -->
            <Table
                id="invoicesTable"
                items="{invoiceList>/invoices}"
                mode="SingleSelectMaster"
                growing="true"
                growingThreshold="20"
                selectionChange="onInvoiceSelect">
                <headerToolbar>
                    <OverflowToolbar>
                        <Title text="{i18n>invoices}" level="H2"/>
                        <ToolbarSpacer/>
                        <SearchField width="50%" search="onSearch" placeholder="{i18n>search}"/>
                    </OverflowToolbar>
                </headerToolbar>
                <columns>
                    <Column width="12em">
                        <Text text="{i18n>number}"/>
                    </Column>
                    <Column minScreenWidth="Tablet" demandPopin="true">
                        <Text text="{i18n>issuer}"/>
                    </Column>
                    <Column minScreenWidth="Tablet" demandPopin="true">
                        <Text text="{i18n>receiver}"/>
                    </Column>
                    <Column minScreenWidth="Desktop" demandPopin="true">
                        <Text text="{i18n>date}"/>
                    </Column>
                    <Column minScreenWidth="Tablet" demandPopin="true" hAlign="Center">
                        <Text text="{i18n>status}"/>
                    </Column>
                    <Column hAlign="End">
                        <Text text="{i18n>amount}"/>
                    </Column>
                    <Column width="4em" hAlign="Center">
                        <Text text=""/>
                    </Column>
                </columns>
                <items>
                    <ColumnListItem type="Navigation">
                        <cells>
                            <ObjectIdentifier
                                title="{invoiceList>numero}"
                                text="{invoiceList>serie}"/>
                            <Text text="{invoiceList>emisor_nombre}"/>
                            <Text text="{invoiceList>receptor_nombre}"/>
                            <Text text="{
                                path: 'invoiceList>fecha_emision',
                                type: 'sap.ui.model.type.Date',
                                formatOptions: { pattern: 'dd/MM/yyyy' }
                            }"/>
                            <ObjectStatus
                                text="{invoiceList>estado}"
                                state="{
                                    path: 'invoiceList>estado',
                                    formatter: '.formatter.statusState'
                                }"/>
                            <ObjectNumber
                                number="{
                                    path: 'invoiceList>total',
                                    type: 'sap.ui.model.type.Currency',
                                    formatOptions: { showMeasure: false }
                                }"
                                unit="EUR"/>
                            <Button icon="sap-icon://action" type="Transparent" press="onInvoiceAction"/>
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </content>
    </Page>
</mvc:View>
