<mvc:View
    controllerName="invoice.app.controller.XmlMapping"
    xmlns="sap.m"
    xmlns:u="sap.ui.unified"
    xmlns:dnd="sap.ui.core.dnd"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:html="http://www.w3.org/1999/xhtml"
    displayBlock="true"
    height="100%">

    <Page title="{i18n>xmlMapping}" showNavButton="true" navButtonPress="onNavBack">
        <content>
            <HBox height="100%" renderType="Bare">
                <!-- SOURCE PANEL -->
                <VBox width="40%" height="100%" class="sapUiSmallMargin">
                    <Title text="{i18n>sourceXML}" level="H3" class="sapUiSmallMarginBottom" />
                    <u:FileUploader
                        id="fileUploaderSource"
                        name="myFileUpload"
                        uploadUrl=""
                        tooltip="Upload your Source XML file"
                        change="onUploadSource"
                        typeMissmatch="handleTypeMissmatch"
                        style="Emphasized"
                        fileType="xsd,xml"
                        mimeType=".xsd,.xml,text/xml,application/xml"
                        multiple="true"
                        placeholder="Choose Source XSD(s)..."
                        class="sapUiSmallMarginBottom"/>
                    
                    <ScrollContainer height="100%" vertical="true" horizontal="true">
                        <Tree
                            id="treeSource"
                            items="{sourceModel>/}"
                            mode="SingleSelectMaster"
                            includeItemInSelection="true"
                            itemPress="onSourceNodeSelect">
                        <dragDropConfig>
                            <dnd:DragInfo
                                groupName="mapping"
                                sourceAggregation="items"
                                dragStart="onDragStart" />
                        </dragDropConfig>
                            <StandardTreeItem title="{sourceModel>name}" />
                        </Tree>
                    </ScrollContainer>
                </VBox>

                <!-- MAPPING CANVAS PANEL (Spacer) -->
                <VBox width="20%" height="100%" justifyContent="Center" alignItems="Center" class="canvasContainer">
                    <core:Icon src="sap-icon://process" size="2rem" color="#ccc" />
                </VBox>

                <!-- TARGET PANEL -->
                <VBox width="40%" height="100%" class="sapUiSmallMargin">
                   <Title text="{i18n>targetXML}" level="H3" class="sapUiSmallMarginBottom" />
                    <u:FileUploader
                        id="fileUploaderTarget"
                        name="myFileUpload"
                        uploadUrl=""
                        tooltip="Upload your Target XML file"
                        change="onUploadTarget"
                        typeMissmatch="handleTypeMissmatch"
                        style="Emphasized"
                        fileType="xsd,xml"
                        mimeType=".xsd,.xml,text/xml,application/xml"
                        multiple="true"
                        placeholder="Choose Target XSD(s)..."
                        class="sapUiSmallMarginBottom"/>

                     <ScrollContainer height="100%" vertical="true" horizontal="true">
                        <Tree
                            id="targetTree"
                            items="{targetModel>/}"
                            mode="SingleSelectMaster"
                            includeItemInSelection="true"
                            selectionChange="onTargetNodeSelect">
                            <dragDropConfig>
                                <dnd:DropInfo
                                    groupName="mapping"
                                    targetAggregation="items"
                                    dropPosition="On"
                                    dropEffect="Link"
                                    drop="onDrop" />
                            </dragDropConfig>
                            <StandardTreeItem title="{targetModel>name}" />
                        </Tree>
                    </ScrollContainer>
                </VBox>
            </HBox>
            
            <!-- Global SVG Overlay for Lines -->
            <core:HTML content='&lt;div id="mappingOverlay" style="position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:99;"&gt;&lt;svg id="svgOverlay" width="100%" height="100%" style="overflow:visible;"&gt;&lt;/svg&gt;&lt;/div&gt;' />
            
        </content>
    </Page>
</mvc:View>
